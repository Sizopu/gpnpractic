<pre>
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              Внешний пользователь                                   │
└──────────────────────────────────────────┬──────────────────────────────────────────┘
                                           │ HTTPS
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                           Nginx (Reverse Proxy & Static Files)                      │
│                           quotation-book-frontend                                   │
│                                                                                     │
│  ┌─────────────────┐    ┌─────────────────────────────────────────────────────┐     │
│  │ Проверка аутен- │    │             Локальное хранилище стат. файлов        │     │
│  │ тификации(токен)│    │                (только .png формат)                 │     │               
│  │  /auth/check    │◀──▶│                  /opt/app-root/static               │     │
│  └─────────────────┘    │                                                     │     │
│           │             │  ┌─────────────────────────────────────────────────┐│     │
│           ▼             │  │                Gallery Images                   ││     │
│  ┌─────────────────┐    │  └─────────────────────────────────────────────────┘│     │
│  │   Routes        │    └─────────────────────────────────────────────────────┘     │
│  │   Приложения    │                                                                │
│  └─────────────────┘                                                                │
└─────────────────────────────┬───────────────────────────────────────────────────────┘
                              │ HTTP
                              ▼
┌──────────────────────────────────────────────────────────────────────────────────┐
│                           Flask Backend (API)                                    │
│                           quotation-book-backend                                 │
│                                                                                  │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────────┐           │
│  │   Auth Routes   │    │  Main Routes    │    │  Service Routes     │           │
│  │  /auth/login    │    │  /jason/*       │    │  /check             │           │
│  │  /auth/callback │    │  /gallery       │    │                     │           │              
│  │  /auth/logout   │    │  /library/*     │    │                     │           │
│  │  /auth/validate │    │                 │    │                     │           │◀──────▶│
│  └─────────────────┘    └─────────────────┘    └─────────────────────┘           │        │
└──────┬─────────────────┬─────────────────┬─────────────────┬─────────────────────┘        │
       ▲                 ▲                 ▲                 ▲                              │ 
       │                 │                 │                 │                              │
       ▼                 ▼                 ▼                 ▼                              │
┌────────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                       │
│   Redis        │  │ PostgreSQL  │  │   MinIO     │  │  RabbitMQ   │                       │ 
│ (Кэширова-     │  │ (Хранение   │  │ (Хранение   │  │ (Очереди    │                       │
│ ние userinfo,  │  │  цитат)     │  │  только pdf │  │ сообщений)  │                       │
│ запросов       │  │             │  │  файлов)    │  │             │                       │ 
│ postgres,      │  │             │  │             │  │             │                       │
│ статуса задач  │  │             │  │             │  │             │                       │
│ backend-worker)│  │             │  │             │  │             │                       │  
│                │  │             │  │             │  │             │                       │
│                │  │             │  │             │  │             │                       │
└────────────────┘  └─────────────┘  └─────────────┘  └──────┬──────┘                       │
                                                             │                              │
                                                             ▼                              │
┌─────────────────────────────────────────────────────────────────────────────────────┐     │
│                        Worker (Background Processing)                               │     │
│                              quotation-book-worker                                  │     │
│                             *3 очереди сообщений:                                   │     │
│                                                                                     │     │
│  ┌─────────────────┐    ┌─────────────────┐    ┌──────────────────────┐             │     │
│  │ Book Generator  │    │ Image Generator │    │ Large Book Gen       │             │     │
│  │ (PDF файлы)     │    │(PNG изображения)│    │ (Объемные  PDF файлы)│             │     │
│  └─────────────────┘    └─────────────────┘    └──────────────────────┘             │     │
└─────────────────────────────────────────────────────────────────────────────────────┘     │
       │                                    │                                               │
       ▼                                    ▼                                               │
  NFS Volume(PNG)                   MinIO S3 Bucket(PDF)                                    │ 
(/opt/app-root/src/static)        (quotation-book-library)                                  │
       │                                    │                                               │
       ▼                                    ▼                                               │
┌─────────────────────────────────────────────────────────────────────────────────────┐     │
│                                        СХД                                          │     │
└─────────────────────────────────────────────────────────────────────────────────────┘     │
                                                                                            │
┌─────────────────────────────────────────────────────────────────────────────────────┐     │
│                              Keycloak (OIDC)                                        │◀───▶│
│                              quotation-book-keycloak                                │
└─────────────────────────────────────────────────────────────────────────────────────┘
</pre>
